---
title: "Group assignment"
author: "Alima Dzhanybaeva"
date: "2022-10-30"
output:
  pdf_document: default
  html_document: default
---
```{r include=FALSE}
library(tidyverse)
library(modelsummary)
library(knitr)
```
## 1.1 Overview of the original data.
### The original hotels-europe data includes information on price and features of hotels in 46 European cities and for 2017-2018. The data was downloaded from https://osf.io/yzntm/download.
### Table 1.1 shows the main variables, their description and type.
```{r include=FALSE}
variables <- c('hotel_id','accommodation_type', 'addresscountryname', 'weekend', 'holiday',
               'center1distance', 'starrating', 'guestreviewrating', 'price', 'price_night',
               'year', 'month')
info <- c('Hotel ID', 'Type of accomodation', 'Country', 'Flag, if day is a weekend',
          'Flag, if day is a public holiday', 'Distance from main city center',
          'Number of stars', 'User rating average', 'Price in EUR', 'Number of nights',
          'Year (YYYY)', 'Month (MM)')
type <- c('numeric', 'string', 'string', 'binary', 'binary', 'string',
          'numeric', 'string', 'numeric', 'string', 'numeric', 'numeric')
description <- data.frame(variables, info, type)
```
```{r echo=FALSE}
kable(description, caption = "Table 1.1 Description of the main variables in the original dataset")
```
## 1.2 Dataset for 7 Central European countries
### For our analysis we used 7 Central European countries: Czech Republic, Germany, Italy, Hungary, Austria, Poland, Slovakia.
```{r}
df <- read.csv('https://osf.io/yzntm/download')
df2 <- df %>% filter(addresscountryname %in% 
                       c('Czech Republic', 'Germany', 'Italy', 
                         'Hungary', 'Austria', 'Poland', 'Slovakia'))

```
### The folowing manipulations were carried out on the original data to change the existing variables and to add new ones:
* The type of the variables *center1distance* and *guestreviewrating* were changed from 'string' to 'numeric'
```{r include=FALSE}
# guestreviewrating separation
df2 <- separate(df2, guestreviewsrating, ' /', into =
                 c('actualrating', 'rate'))
df2 <- select(df2, -rate)
df2$actualrating <- as.numeric(df2$actualrating)

# Distance
df2 <- separate(df2, center1distance, ' ', into =
                  c('distance', 'miles'))
df2 <- select(df2, -miles)
df2$distance <- as.numeric(df2$distance)
```
* The original *accommodationtype* variable was tranformed into new *accomtype* factor variable.
```{r}
df2 <- separate(df2, accommodationtype, '@', into = 
                 c('word', 'acctype'))
df2 <- select(df2, -word)
df2 <- mutate(df2, acctype_f = factor(acctype))
```
* *trueprice* variable was generated by dividing the original *price* variable by *price_night*
```{r}
df2 <- separate(df2, price_night, ' ', into =
                     c('pr','word', 'nights', 'night'))
df2 <- select(df2, -pr)
df2 <- select(df2, -night)
df2 <- select(df2, -word)
df2$nights <- as.numeric(df2$nights)
df2$trueprice <- df2$price/df2$nights
```
* *season* variable was created based on the *month* variable
```{r}
df2 <- df2 %>%
  mutate(season = case_when(month == 12 | month == 1 |month == 2 ~ 'winter',
                            month == 3 | month == 4 |month == 5 ~ 'spring',
                            month == 6 | month == 7 |month == 8 ~ 'summer',
                            month == 9 | month == 10 |month == 11 ~ 'autumn'))
```
* With the help of the existing *starrating* variable new *class* variable was generated
```{r}
df2 <- df2 %>%
  mutate(class = case_when(starrating == 0.0 | starrating == 1.0 ~ 'tourist',
                           starrating == 1.5 | starrating == 2.0 ~ 'standard',
                           starrating == 2.5 | starrating == 3.0 ~ 'comfort',
                           starrating == 3.5 | starrating == 4.0 ~ 'first class',
                           starrating == 4.5 | starrating == 5.0 ~ 'luxury'))
```

## Summary of the transformed dataset
```{r}
datasummary(starrating + actualrating + trueprice ~ Mean + Min + Max + SD, data = df2)
```
